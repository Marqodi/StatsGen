---
title: "Modelling for Field Biologists - Chapter Exercises"
author: "Marqus Odisho"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Chapter 3: Quantitative Genetics
#### Box 3.1 

```{r Box 3.1}
# Creating Fig 3.3 which shows shifting phenotypes under perfect heritability
distr_shift <- function(variance, initial_mean, a, b) {
  z <- seq(13, 17, length.out = 201)
  f <- 1/(2*sqrt(variance))*exp(-0.5*((z-initial_mean)/(sqrt(variance)))^2)
  f0 <- f/sum(f)
  r <- a*(z-b)
  f1 <- f0*exp(r)
  f1 <- f1/sum(f1)
  plot(z, f0, type = "l", col = "blue", xlab = "z", ylab = "Density")
  lines(z, f1, col = "red")
  legend("topright", legend = c("f0", "f1"), col = c("blue", "red"), lty = 1)
  new_mean <- sum(f1*z)
  shift <- new_mean - initial_mean
  return(list(shift = shift, f0 = f0, f1 = f1, z = z))
}

# Example usage
shift <- distr_shift(0.1, 15, 1, 15)$shift 

```
